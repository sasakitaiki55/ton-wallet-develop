!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function s(e){return document.querySelector(e)}function o(e){return document.querySelectorAll(e)}function a(e,t){let n=t;!0===t&&(n="block"),!1===t&&(n="none"),e.style.display=n}function r(e,t,n){(n=n||{}).isBack?e.classList.add("isBack"):e.classList.remove("isBack"),t?(e.classList.add("faded-show"),e.classList.remove("faded-hide")):(e.classList.remove("faded-show"),e.classList.add("faded-hide"))}function i(e,t,n){e.classList.add(t),setTimeout(()=>{e.classList.remove(t)},n)}function c(e){const t=document.createElement(e.tag);if(e.clazz)if(Array.isArray(e.clazz))for(let n of e.clazz)n&&t.classList.add(n);else t.classList.add(e.clazz);if(e.text&&(t.innerText=e.text),e.child)for(let n of e.child)n&&t.appendChild(n);if(e.style)for(let n in e.style)t.style[n]=e.style[n];return t}function d(e,t){return e.innerHTML="",e.appendChild(document.createTextNode(t.substring(0,t.length/2))),e.appendChild(document.createElement("wbr")),e.appendChild(document.createTextNode(t.substring(t.length/2))),e}function l(e){e.innerHTML=""}function u(e,t){e.addEventListener("change",t),e.addEventListener("input",t),e.addEventListener("cut",t),e.addEventListener("paste",t)}function p(e){return e<10?"0"+e:e}n.r(t);const h=["January","February","March","April","May","June","July","August","September","October","November","December"];function g(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();var n=!1;try{n=document.execCommand("copy")?"successful":"unsuccessful"}catch(e){}return document.body.removeChild(t),n}var m={};function w(e){return new Promise((t,n)=>{const s=e.getAttribute("src"),o=e.getAttribute("data-name"),a=Number(e.getAttribute("width")),r=Number(e.getAttribute("height")),i=new XMLHttpRequest;i.responseType="arraybuffer",i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){const n=document.createElement("canvas");n.setAttribute("width",a*window.devicePixelRatio),n.setAttribute("height",r*window.devicePixelRatio),n.style.width=a+"px",n.style.height=r+"px",e.appendChild(n);const s=n.getContext("2d"),c=JSON.parse(new TextDecoder("utf-8").decode(pako.inflate(i.response)));m[o]={ctx:s,player:lottie.loadAnimation({renderer:"canvas",loop:"processing"===o||"start"===o||"about"===o,autoplay:!1,animationData:c,rendererSettings:{context:s,scaleMode:"noScale",clearCanvas:!0}})},s.clearRect(0,0,1e3,1e3),t()}else n()},i.open("GET",s,!0),i.send(null)})}class v{constructor(e,t,n){this.container=e,this.onEnter=t,this.mnemonicWords=n}show(e,t){l(this.container);const n=t=>{e.value=t.target.innerText,e.classList.remove("error"),this.hide(),t.preventDefault(),this.onEnter(e)};this.mnemonicWords.filter(e=>0===e.indexOf(t)).forEach(e=>{const t=c({tag:"div",clazz:"words-popup-item",text:e});t.addEventListener("mousedown",n),this.container.appendChild(t)}),this.selectedI=-1,this.container.children.length>0&&this.select(0),this.container.style.left=e.offsetLeft+"px",this.container.style.top=e.offsetTop+e.offsetHeight+"px",a(this.container,!0)}hide(){a(this.container,!1),l(this.container),this.selectedI=-1}select(e){if(this.selectedI>-1&&this.container.children[this.selectedI].classList.remove("selected"),this.selectedI=e,this.selectedI>-1){this.container.children[this.selectedI].classList.add("selected");const e=30;this.container.scrollTo(0,e*this.selectedI)}}getSelectedText(){return-1===this.selectedI?null:this.container.children[this.selectedI].innerText}up(){-1!==this.selectedI&&this.selectedI>0&&this.select(this.selectedI-1)}down(){-1!==this.selectedI&&this.selectedI<this.container.children.length-1&&this.select(this.selectedI+1)}}const f=TonWeb.utils.toNano,k=TonWeb.utils.fromNano,L=TonWeb.utils.BN;function b(e,t,n){n=n||{},clearTimeout(e.hideTimeout),t?e.player.play():(e.player.stop(),n.hideDelay?e.hideTimeout=setTimeout(()=>{e.ctx.clearRect(0,0,1e3,1e3)},n.hideDelay):e.ctx.clearRect(0,0,1e3,1e3))}const x=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;window.view=new class{constructor(e){function t(e){e.target.classList.remove("error")}this.mnemonicWords=e,this.controller=null,this.port=null,this.myAddress=null,this.balance=null,this.currentScreenName=null,this.isTestnet=!1,this.popup="",this.createWordInputs({count:24,dropdownId:"#wordsPopup",inputId:"#importsInput",containerId:"#importWords",multiColumns:!0}),this.createWordInputs({count:3,dropdownId:"#wordsConfirmPopup",inputId:"#confirmInput",containerId:"#confirmWords",multiColumns:!1}),async function(){const e=o("tgs-player");for(let t=0;t<e.length;t++)await w(e[t])}().then(()=>{const e=m[this.currentScreenName];e&&b(e,!0)}),u(s("#amountInput"),t),u(s("#toWalletInput"),t),u(s("#createPassword_repeatInput"),t),u(s("#enterPassword_input"),t),u(s("#changePassword_oldInput"),t),u(s("#changePassword_newInput"),t),u(s("#changePassword_repeatInput"),t),s("#toWalletInput").addEventListener("paste",e=>{const t=function(e){const t=(e.clipboardData||window.clipboardData).getData("text");try{return decodeURI(t).replaceAll(/%23/g,"#")}catch(e){return t}}(e);if(t.startsWith("ton://transfer/")){if(63!==t.length&&"?"!==t[63])return void e.preventDefault();let n=t.substring("ton://transfer/".length);s("#toWalletInput").value=n.substring(0,48),n=n.substring(49),n.split("&").map(e=>e.split("=")).forEach(e=>{"amount"===e[0]?s("#amountInput").value=TonWeb.utils.fromNano(new L(e[1])):"text"===e[0]&&(s("#commentInput").value=e[1])}),e.preventDefault()}}),u(s("#invoice_amountInput"),()=>this.updateInvoiceLink()),u(s("#invoice_commentInput"),()=>this.updateInvoiceLink()),s("#start_createBtn").addEventListener("click",()=>this.sendMessage("showScreen",{name:"created"})),s("#start_importBtn").addEventListener("click",()=>this.sendMessage("showScreen",{name:"import"}));let n=!1;try{n=window.location.href.indexOf("ledgerReview")>-1}catch(e){}n&&a(s("#start_importLedgerHidBtn"),"inline-block"),s("#start_importLedgerHidBtn").addEventListener("click",()=>{this.showPopup("connectLedger"),this.sendMessage("showScreen",{name:"importLedger",transportType:"hid"})}),s("#import_backBtn").addEventListener("click",()=>{this.isBack=!0,this.sendMessage("onImportBack")}),s("#import_alertBtn").addEventListener("click",()=>{this.showAlert({title:"Too Bad",message:"Without the secret words, you can't restore access to your wallet.",buttons:[{label:"CANCEL",callback:()=>{this.isBack=!0,this.sendMessage("onImportBack")}},{label:"ENTER WORDS",callback:()=>{this.closePopup()}}]})}),s("#import_continueBtn").addEventListener("click",async e=>{this.toggleButtonLoader(e.currentTarget,!0),this.sendMessage("import",{words:await this.getImportWords()})}),s("#createdContinueButton").addEventListener("click",()=>this.sendMessage("createPrivateKey")),s("#backup_continueBtn").addEventListener("click",()=>{+new Date-this.backupShownTime<6e4?this.showAlert({title:"Sure done?",message:"You didn't have enough time to write these words down.",buttons:[{label:"I'M SURE",callback:()=>{this.sendMessage("onBackupDone")}},{label:"OK, SORRY",callback:()=>{this.closePopup()}}]}):this.sendMessage("onBackupDone")}),s("#wordsConfirm_backBtn").addEventListener("click",()=>{this.isBack=!0,this.sendMessage("onConfirmBack")}),s("#wordsConfirm_continueBtn").addEventListener("click",()=>{const e=this.getConfirmWords();e.isWordsFromList&&(e.isRightWords?this.sendMessage("onConfirmDone",{words:e.words}):this.showAlert({title:"Incorrect words",message:"The secret words you have entered do not match the ones in the list.",buttons:[{label:"SEE WORDS",callback:()=>{this.isBack=!0,this.sendMessage("onConfirmBack")}},{label:"TRY AGAIN",callback:()=>{this.closePopup()}}]}))}),s("#createPassword_continueBtn").addEventListener("click",e=>{const t=s("#createPassword_input").value,n=s("#createPassword_repeatInput").value;0===t.length&&!this.isTestnet?s("#createPassword_input").classList.add("error"):t!==n?s("#createPassword_repeatInput").classList.add("error"):(this.toggleButtonLoader(e.currentTarget,!0),this.sendMessage("passwordCreated",{password:t}))}),s("#readyToGo_continueBtn").addEventListener("click",()=>this.sendMessage("showMain")),s("#main_refreshBtn").addEventListener("click",()=>{this.setUpdating(!0),this.sendMessage("update")}),s("#main_settingsButton").addEventListener("click",()=>this.onSettingsClick()),s("#main_receiveBtn").addEventListener("click",()=>{a(s("#receive_showAddressOnDeviceBtn"),!!this.isLedger),this.showPopup("receive")}),s("#sendButton").addEventListener("click",()=>this.onMessage("showPopup",{name:"send"})),s("#modal").addEventListener("click",()=>this.closePopup()),x&&(a(s("#menu_magic"),!1),a(s(".about-magic"),!1)),s("#menu_magic").addEventListener("click",()=>{s("#menu_magic .dropdown-toggle").classList.toggle("toggle-on");const e=s("#menu_magic .dropdown-toggle").classList.contains("toggle-on");s("#menu_telegram").classList.toggle("menu_telegram-show",e),this.sendMessage("onMagicClick",e)}),s("#menu_telegram").addEventListener("click",()=>{chrome.tabs.update({url:"https://web.telegram.org/z"})}),s("#menu_proxy").addEventListener("click",()=>{s("#menu_proxy .dropdown-toggle").classList.toggle("toggle-on"),this.sendMessage("onProxyClick",s("#menu_proxy .dropdown-toggle").classList.contains("toggle-on"))}),s("#menu_extension_chrome").addEventListener("click",()=>window.open("https://chrome.google.com/webstore/detail/ton-wallet/nphplpgoakhhjchkkhmiggakijnkhfnd","_blank")),s("#menu_extension_firefox").addEventListener("click",()=>window.open("https://addons.mozilla.org/ru/firefox/addon/","_blank")),s("#menu_about").addEventListener("click",()=>this.showPopup("about")),s("#menu_changePassword").addEventListener("click",()=>this.onMessage("showPopup",{name:"changePassword"})),s("#menu_backupWallet").addEventListener("click",()=>this.sendMessage("onBackupWalletClick")),s("#menu_delete").addEventListener("click",()=>this.showPopup("delete")),s("#receive_showAddressOnDeviceBtn").addEventListener("click",()=>this.onShowAddressOnDevice()),s("#receive_invoiceBtn").addEventListener("click",()=>this.onCreateInvoiceClick()),s("#receive_shareBtn").addEventListener("click",()=>this.onShareAddressClick(!1)),s("#receive .addr").addEventListener("click",()=>this.onShareAddressClick(!0)),s("#receive_closeBtn").addEventListener("click",()=>this.closePopup()),s("#invoice_qrBtn").addEventListener("click",()=>this.onCreateInvoiceQrClick()),s("#invoice_shareBtn").addEventListener("click",()=>this.onShareInvoiceClick()),s("#invoice_closeBtn").addEventListener("click",()=>this.showPopup("receive")),s("#invoiceQr_shareBtn").addEventListener("click",()=>this.onShareInvoiceClick()),s("#invoiceQr_closeBtn").addEventListener("click",()=>this.showPopup("invoice")),s("#transaction_sendBtn").addEventListener("click",()=>this.onTransactionButtonClick()),s("#transaction_closeBtn").addEventListener("click",()=>this.closePopup()),s("#connectLedger_cancelBtn").addEventListener("click",()=>this.closePopup()),s("#send_btn").addEventListener("click",e=>{const t=Number(s("#amountInput").value),n=f(t);if(!n.gt(new L(0))||this.balance.lt(n))return void s("#amountInput").classList.add("error");const o=s("#toWalletInput").value;if(!TonWeb.Address.isValid(o))return void s("#toWalletInput").classList.add("error");const a=s("#commentInput").value;this.toggleButtonLoader(e.currentTarget,!0),this.sendMessage("onSend",{amount:n.toString(),toAddress:o,comment:a})}),s("#send_closeBtn").addEventListener("click",()=>this.closePopup()),s("#sendConfirm_closeBtn").addEventListener("click",()=>this.closePopup()),s("#sendConfirm_cancelBtn").addEventListener("click",()=>this.closePopup()),s("#sendConfirm_okBtn").addEventListener("click",()=>this.onMessage("showPopup",{name:"enterPassword"})),s("#signConfirm_closeBtn").addEventListener("click",()=>this.closePopup()),s("#signConfirm_cancelBtn").addEventListener("click",()=>this.closePopup()),s("#signConfirm_okBtn").addEventListener("click",()=>this.onMessage("showPopup",{name:"enterPassword"})),s("#processing_closeBtn").addEventListener("click",()=>this.closePopup()),s("#done_closeBtn").addEventListener("click",()=>this.closePopup()),s("#about_closeBtn").addEventListener("click",()=>this.closePopup()),s("#changePassword_cancelBtn").addEventListener("click",()=>this.closePopup()),s("#changePassword_okBtn").addEventListener("click",async e=>{const t=s("#changePassword_oldInput").value,n=s("#changePassword_newInput").value,o=s("#changePassword_repeatInput").value;0!==n.length||this.isTestnet?n===o?(this.toggleButtonLoader(e.currentTarget,!0),this.sendMessage("onChangePassword",{oldPassword:t,newPassword:n})):s("#changePassword_repeatInput").classList.add("error"):s("#changePassword_newInput").classList.add("error")}),s("#enterPassword_cancelBtn").addEventListener("click",()=>this.closePopup()),s("#enterPassword_okBtn").addEventListener("click",async e=>{const t=s("#enterPassword_input").value;this.toggleButtonLoader(e.currentTarget,!0),this.sendMessage("onEnterPassword",{password:t})}),s("#delete_cancelBtn").addEventListener("click",()=>this.closePopup()),s("#delete_okBtn").addEventListener("click",()=>this.sendMessage("disconnect"))}showScreen(e){this.closePopup();["start","created","backup","wordsConfirm","import","createPassword","readyToGo","main"].forEach(t=>{r(s("#"+t),e===t,{isBack:this.isBack});const n=m[t];n&&b(n,e===t,{hideDelay:300})}),this.currentScreenName=e,this.isBack=!1,window.scrollTo(0,0)}toggleButtonLoader(e,t){e.disabled=t,t?e.classList.add("btn-loader"):e.classList.remove("btn-loader")}showAlert(e){s("#alert .popup-title").innerText=e.title,s("#alert .popup-black-text").innerText=e.message,s("#alert .popup-footer").innerHTML="",e.buttons&&e.buttons.forEach(e=>{const t=c({tag:"button",clazz:"btn-lite",text:e.label});s("#alert .popup-footer").appendChild(t),t.addEventListener("click",e.callback)}),this.showPopup("alert")}showPopup(e){s("#enterPassword_input").value="",this.popup&&e&&i(document.body,"disable-animations",20),r(s("#modal"),""!==e);["alert","receive","invoice","invoiceQr","send","sendConfirm","signConfirm","processing","done","menuDropdown","about","delete","changePassword","enterPassword","transaction","connectLedger"].forEach(t=>{r(s("#"+t),e===t);const n=m[t];n&&b(n,e===t)}),this.popup=e}closePopup(){this.showPopup(""),this.sendMessage("onClosePopup")}setBackupWords(e){const t=t=>{s("#createWords").appendChild(c({tag:"div",clazz:"create-word-item",child:[c({tag:"span",clazz:"word-num",text:t+1+"."}),c({tag:"span",style:{"font-weight":"bold"},text:e[t]})]}))};l(s("#createWords"));for(let n=0;n<e.length/2;n++)t(n),t(n+12)}clearBackupWords(){l(s("#createWords"))}createWordInputs(e){const t=t=>{const n=Number(t.getAttribute("tabindex"));n===e.count||s(e.inputId+n).focus()},n=new v(s(e.dropdownId),t,this.mnemonicWords);let o=null;const r=t=>{const o=t.value;null!==o&&0!==o.length?n.show(t,o.toLowerCase()):a(s(e.dropdownId),!1)};function i(e){const t=e.target;t.classList.remove("error"),r(t)}const d=e=>{const t=e.target;o=t,r(t)},l=t=>{if(a(s(e.dropdownId),!1),o){const e=o.value.toLowerCase().trim();e.length>0&&-1===this.mnemonicWords.indexOf(e)?o.classList.add("error"):o.classList.remove("error")}},p=e=>{const s=e.target;switch(e.key){case"Enter":const e=n.getSelectedText();e&&(s.value=e,s.classList.remove("error"),n.hide()),t(s);break;case"ArrowUp":n.up();break;case"ArrowDown":n.down()}},h=t=>{const n=(t.clipboardData||window.clipboardData).getData("text");let o=n.split(" ");if(o.length!==e.count&&(o=n.split(",")),o.length===e.count){for(let t=0;t<e.count;t++){const n=s(e.inputId+t),a=o[t].toLowerCase().trim();a&&-1!==this.mnemonicWords.indexOf(a)?n.classList.remove("error"):n.classList.add("error"),n.value=a}t.preventDefault()}},g=t=>{const n=c({tag:"div",clazz:"word-item"}),o=c({tag:"span",clazz:"word-num",text:t+1+"."});n.appendChild(o);const a=c({tag:"input"});a.id=e.inputId.slice(1)+t,a.type="text",a.tabIndex=t+1,a.autocomplete="off",n.appendChild(a),a.addEventListener("focusin",d),a.addEventListener("focusout",l),a.addEventListener("keydown",p),a.addEventListener("paste",h),u(a,i),s(e.containerId).appendChild(n)};if(e.multiColumns)for(let t=0;t<e.count/2;t++)g(t),g(t+e.count/2);else for(let t=0;t<e.count;t++)g(t)}clearImportWords(){a(s("#wordsPopup"),!1);for(let e=0;e<24;e++){const t=s("#importsInput"+e);t.value="",t.classList.remove("error")}}clearConfirmWords(){a(s("#wordsConfirmPopup"),!1);for(let e=0;e<3;e++){const t=s("#confirmInput"+e);t.value="",t.setAttribute("data-word",""),t.classList.remove("error")}}setConfirmWords(e){const t=Array(24).fill(0).map((e,t)=>({i:t,rnd:Math.random()})).sort((e,t)=>e.rnd-t.rnd).map(e=>e.i).slice(0,3).sort((e,t)=>e-t),n=o("#confirmWordsNums span");for(let o=0;o<3;o++){const a=s("#confirmInput"+o);a.setAttribute("data-index",t[o]),a.setAttribute("data-word",e[t[o]]),n[o].innerText=t[o]+1,a.parentNode.children[0].innerText=t[o]+1+"."}}async getImportWords(){let e=!0;const t=[];for(let n=0;n<24;n++){const o=s("#importsInput"+n),a=o.value.toLowerCase().trim();a&&-1!==this.mnemonicWords.indexOf(a)||(o.classList.add("error"),e=!1),t.push(a)}if(e&&(e=await TonWeb.mnemonic.validateMnemonic(t),!e))for(let e=0;e<24;e++){s("#importsInput"+e).classList.add("error")}return e?t:null}getConfirmWords(){let e=!0,t=!0;const n={};for(let o=0;o<3;o++){const a=s("#confirmInput"+o),r=a.value.toLowerCase().trim(),i=a.getAttribute("data-index"),c=a.getAttribute("data-word");r&&-1!==this.mnemonicWords.indexOf(r)||(a.classList.add("error"),e=!1),r!==c&&(t=!1),n[i]=r}return{isWordsFromList:e,isRightWords:t,words:e&&t?n:null}}clearCreatePassword(){s("#createPassword_input").value="",s("#createPassword_repeatInput").value=""}clearChangePassword(){s("#changePassword_oldInput").value="",s("#changePassword_newInput").value="",s("#changePassword_repeatInput").value=""}setUpdating(e){s("#updateLabel").innerText=e?"updating..":"updated just now"}onSettingsClick(){r(s("#modal"),!0),r(s("#menuDropdown"),!0),a(s("#menu_changePassword"),!this.isLedger),a(s("#menu_backupWallet"),!this.isLedger)}clearBalance(){l(s("#balance")),s("#balance").innerText="💎",l(s("#transactionsList")),a(s("#walletCreated"),!1)}setBalance(e,t){this.balance=e;let n=k(e);"0"===n&&(n="0.00");const o=n.indexOf("."),r=n.substring(0,o),i=n.substring(o);l(s("#balance")),s("#balance").appendChild(c({tag:"span",text:r})),s("#balance").appendChild(c({tag:"span",style:{"font-size":"24px"},text:i})),s("#balance").appendChild(c({tag:"span",text:" 💎"})),s("#sendBalance").innerText="Balance: "+n+" 💎",a(s("#sendButton"),e.gt(new L(0))?"inline-block":"none"),this.setTransactions(t),this.setUpdating(!1)}setTransactions(e){l(s("#transactionsList"));let t="";a(s("#walletCreated"),0===e.length),e.forEach(e=>{e.amount=new L(e.amount),e.fee=new L(e.fee),e.otherFee=new L(e.otherFee),e.storageFee=new L(e.storageFee),e.date=new Date(e.date);const n=function(e){return h[e.getMonth()]+" "+e.getDate()}(e.date);t!==n&&(this.addDateSeparator(n),t=n),this.addTx(e)})}addDateSeparator(e){s("#transactionsList").appendChild(c({tag:"div",clazz:"date-separator",text:e}))}addTx(e){const t=!e.amount.isNeg(),n=k(e.amount),o=t?e.from_addr:e.to_addr,a=c({tag:"div",clazz:"tx-item",child:[c({tag:"div",child:t?[c({tag:"span",clazz:["tx-amount","tx-amount-green"],text:"+"+n}),c({tag:"span",text:" 💎"}),c({tag:"span",clazz:"tx-from",text:" from:"})]:[c({tag:"span",clazz:"tx-amount",text:n}),c({tag:"span",text:" 💎"}),c({tag:"span",clazz:"tx-from",text:" to:"})]}),d(c({tag:"div",clazz:["tx-addr","addr"]}),o),e.comment?c({tag:"div",clazz:"tx-comment",text:e.comment}):void 0,c({tag:"div",clazz:"tx-fee",text:`blockchain fees: ${k(e.fee)}`}),c({tag:"div",clazz:"tx-item-date",text:(r=e.date,p(r.getHours())+":"+p(r.getMinutes()))})]});var r;a.addEventListener("click",()=>this.onTransactionClick(e)),s("#transactionsList").appendChild(a)}onTransactionClick(e){this.showPopup("transaction");const t=!e.amount.isNeg(),n=t?e.from_addr:e.to_addr;this.currentTransactionAddr=n;const o=k(e.amount);s("#transactionAmount").innerText=(t?"+"+o:o)+" 💎",s("#transactionFee").innerText=k(e.otherFee)+" transaction fee",s("#transactionStorageFee").innerText=k(e.storageFee)+" storage fee",s("#transactionSenderLabel").innerText=t?"Sender":"Recipient",d(s("#transactionSender"),n),a(s("#transactionCommentLabel"),!!e.comment),s("#transactionComment").innerText=e.comment,s("#transactionDate").innerText=e.date.toString()}onTransactionButtonClick(){this.onMessage("showPopup",{name:"send",toAddr:this.currentTransactionAddr})}clearSend(){s("#toWalletInput").value="",s("#amountInput").value="",s("#commentInput").value=""}setMyAddress(e){d(s("#receive .addr"),e),l(s("#qr"));const t={text:"ton://transfer/"+e,width:185*window.devicePixelRatio,height:185*window.devicePixelRatio,logo:"assets/gem@large.png",logoWidth:44*window.devicePixelRatio,logoHeight:44*window.devicePixelRatio,correctLevel:QRCode.CorrectLevel.L};new QRCode(s("#qr"),t)}onShareAddressClick(e){const t=e?this.myAddress:"ton://transfer/"+this.myAddress,n=e?"Wallet address copied to clipboard":"Transfer link copied to clipboard";s("#notify").innerText=g(t)?n:"Can't copy link",i(s("#notify"),"faded-show",2e3)}onShowAddressOnDevice(){this.sendMessage("showAddressOnDevice"),s("#notify").innerText="Please check the address on your device",i(s("#notify"),"faded-show",2e3)}onCreateInvoiceClick(){this.onMessage("showPopup",{name:"invoice"})}updateInvoiceLink(){s("#invoice_link").innerText=this.getInvoiceLink()}getInvoiceLink(){let e="ton://transfer/"+this.myAddress;const t=[],n=s("#invoice_amountInput").value;n&&t.push("amount="+f(Number(n)));const o=s("#invoice_commentInput").value;return o&&t.push("text="+o),0===t.length?e:e+"?"+t.join("&")}onShareInvoiceClick(){s("#notify").innerText=g(this.getInvoiceLink())?"Transfer link copied to clipboard":"Can't copy link",i(s("#notify"),"faded-show",2e3)}onCreateInvoiceQrClick(){this.onMessage("showPopup",{name:"invoiceQr"})}drawInvoiceQr(e){l(s("#invoiceQrImg"));const t={text:e,width:185*window.devicePixelRatio,height:185*window.devicePixelRatio,logo:"assets/gem@large.png",logoWidth:44*window.devicePixelRatio,logoHeight:44*window.devicePixelRatio,correctLevel:QRCode.CorrectLevel.L};new QRCode(s("#invoiceQrImg"),t)}sendMessage(e,t){this.controller?this.controller.onViewMessage(e,t):this.port.postMessage({method:e,params:t})}onMessage(e,t){switch(e){case"disableCreated":s("#createdContinueButton").disabled=t;break;case"setIsTestnet":this.isTestnet=t,s(".your-balance").innerText=t?"Your testnet balance":"Your mainnet balance";break;case"setBalance":this.setBalance(new L(t.balance),t.txs);break;case"setIsLedger":this.isLedger=t;break;case"setIsMagic":const e=t;s("#menu_magic .dropdown-toggle").classList.toggle("toggle-on",e&&!x),s("#menu_telegram").classList.toggle("menu_telegram-show",e&&!x);break;case"setIsProxy":t?s("#menu_proxy .dropdown-toggle").classList.add("toggle-on"):s("#menu_proxy .dropdown-toggle").classList.remove("toggle-on");break;case"privateKeySaved":this.toggleButtonLoader(s("#createPassword_continueBtn"),!1);break;case"passwordChanged":this.toggleButtonLoader(s("#changePassword_okBtn"),!1);break;case"showChangePasswordError":this.toggleButtonLoader(s("#changePassword_okBtn"),!1),s("#changePassword_oldInput").classList.add("error");break;case"passwordEntered":this.toggleButtonLoader(s("#enterPassword_okBtn"),!1);break;case"showEnterPasswordError":this.toggleButtonLoader(s("#enterPassword_okBtn"),!1),s("#enterPassword_input").classList.add("error");break;case"importCompleted":this.toggleButtonLoader(s("#import_continueBtn"),!1);break;case"sendCheckFailed":case"sendCheckSucceeded":this.toggleButtonLoader(s("#send_btn"),!1);break;case"sendCheckCantPayFee":this.toggleButtonLoader(s("#send_btn"),!1),s("#amountInput").classList.add("error"),s("#notify").innerText=`Estimated fee is ~${k(t.fee)} TON`,i(s("#notify"),"faded-show",3e3);break;case"showScreen":switch(t.noAnimation&&i(document.body,"disable-animations",300),this.showScreen(t.name),t.name){case"start":this.clearBalance(),this.clearImportWords();break;case"created":break;case"import":this.clearImportWords(),s("#importsInput0").focus();break;case"backup":this.clearConfirmWords(),this.setBackupWords(t.words),this.backupShownTime=t.isFirst?+new Date:0;break;case"wordsConfirm":this.clearConfirmWords(),this.clearBackupWords(),s("#confirmInput0").focus(),this.setConfirmWords(t.words);break;case"createPassword":this.clearImportWords(),this.clearConfirmWords(),this.clearCreatePassword(),s("#createPassword_input").focus();break;case"readyToGo":this.clearCreatePassword();break;case"main":this.clearBackupWords(),t.myAddress&&(this.myAddress=t.myAddress,this.setMyAddress(t.myAddress))}break;case"showPopup":switch(this.showPopup(t.name),t.name){case"changePassword":this.clearChangePassword(),s("#changePassword_oldInput").focus();break;case"enterPassword":s("#enterPassword_input").focus();break;case"done":s("#done .popup-grey-text").innerText=t.message;break;case"invoice":s("#invoice_amountInput").value="",s("#invoice_commentInput").value="",this.updateInvoiceLink(),s("#invoice_amountInput").focus();break;case"invoiceQr":this.drawInvoiceQr(this.getInvoiceLink()),s("#invoiceQrAmount").innerText=s("#invoice_amountInput").value;break;case"send":this.clearSend(),t.toAddr&&(s("#toWalletInput").value=t.toAddr),a(s("#commentInput"),!this.isLedger),s("#toWalletInput").focus();break;case"sendConfirm":s("#sendConfirmAmount").innerText=k(new L(t.amount))+" TON",d(s("#sendConfirmAddr"),t.toAddress),s("#sendConfirmFee").innerText=t.fee?"Fee: ~"+k(new L(t.fee))+" TON":"",a(s("#sendConfirm .popup-footer"),!this.isLedger),a(s("#sendConfirm_closeBtn"),!this.isLedger);break;case"signConfirm":const e=t.data.length>48?t.data.substring(0,47)+"…":t.data;d(s("#signConfirmData"),e)}break;case"closePopup":this.closePopup();break;case"restoreDeprecatedStorage":const n=localStorage.getItem("address"),o=localStorage.getItem("words"),r=localStorage.getItem("walletVersion"),c=localStorage.getItem("magic"),l=localStorage.getItem("proxy");return localStorage.clear(),{address:n,words:o,walletVersion:r,magic:c,proxy:l}}}}(TonWeb.mnemonic.wordlists.EN);try{const e=chrome.runtime.connect({name:"gramWalletPopup"});window.view.port=e,e.onMessage.addListener((function(t){const n=window.view.onMessage(t.method,t.params);n&&t.id&&e.postMessage({method:"response",id:t.id,result:n})}))}catch(e){}if(window.top==window&&window.console){const e={"ru-RU":["Внимание!","Используя эту консоль, вы можете подвергнуться атаке Self-XSS, что позволит злоумышленникам завладеть вашим кошельком.\nНе вводите и не вставляйте программный код, который не понимаете."],"*":["Attention!","Using this console, you can be exposed to a Self-XSS attack, allowing attackers to take over your wallet.\nDo not enter or paste program code that you do not understand."]};let t=e[navigator.language||navigator.userLanguage];t||(t=e["*"]),console.log("%c%s","color: red; background: yellow; font-size: 24px;",t[0]),console.log("%c%s","font-size: 18px;",t[1])}}]);